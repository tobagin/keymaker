using Gtk 4.0;
using Adw 1;

template $KeyMakerAddKeyToAgentDialog : Adw.Dialog {
  title: _("Add Key to Agent");
  content-width: 800;
  content-height: 600;

  child: Adw.ToolbarView {
    top-bar-style: raised;
    bottom-bar-style: raised;
    
    [top]
    Adw.HeaderBar {
      title-widget: Adw.WindowTitle {
        title: _("Add Key to Agent");
        subtitle: _("Add SSH keys to the authentication agent");
      };
    }

    content: ScrolledWindow {
      vexpand: true;
      
      Adw.Clamp {
        maximum-size: 800;
        tightening-threshold: 600;
      
      Box {
        orientation: vertical;
        spacing: 24;
        margin-top: 24;
        margin-bottom: 24;
        margin-start: 24;
        margin-end: 24;
        
        Adw.PreferencesGroup {
          title: _("Select Key");
          description: _("Choose an SSH key to add to the agent");
          
          ScrolledWindow {
            min-content-height: 200;
            max-content-height: 300;
            
            ListBox keys_list {
              selection-mode: single;
              styles ["boxed-list"]
            }
          }
        }
        
        Adw.PreferencesGroup {
          title: _("Options");
          
          Adw.SwitchRow enable_timeout_row {
            title: _("Auto-remove after timeout");
            subtitle: _("Automatically remove key from agent after specified time");
            
            [prefix]
            Image {
              icon-name: "preferences-system-time-symbolic";
              icon-size: large;
            }
          }
          
          Adw.SpinRow timeout_row {
            title: _("Timeout (minutes)");
            subtitle: _("Key will be removed after this many minutes");
            sensitive: false;
            adjustment: Adjustment {
              lower: 1;
              upper: 1440;
              value: 60;
              step-increment: 1;
              page-increment: 60;
            };
            
            [prefix]
            Image {
              icon-name: "alarm-symbolic";
              icon-size: large;
            }
          }
        }
        
        // Action buttons moved to bottom headerbar
        }
      }
    };
    
    [bottom]
    Adw.HeaderBar {
      show-end-title-buttons: false;
      title-widget: Button add_button {
        label: _("Add to Agent");
        sensitive: false;
        styles ["suggested-action"]
      };
    }
  };
}
